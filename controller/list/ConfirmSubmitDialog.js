/*
 * Copyright (C) 2009-2020 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["sap/m/Link","sap/m/MessageStrip","sap/ui/base/Object","sap/ui/core/Fragment","sap/ui/Global","sap/ui/model/json/JSONModel","fin/ap/approvebankpayments/model/Messaging"],function(L,M,B,F,U,J,a){"use strict";var f={"":"fin.ap.approvebankpayments.view.list.ConfirmSubmitNoAuthDialog","S":"fin.ap.approvebankpayments.view.list.ConfirmSubmitSmsDialog","I":"fin.ap.approvebankpayments.view.list.ConfirmSubmitAppDialog"};var s={"":"confirmSubmitDialogTitle","O":"confirmSubmitSingleDialogTitle"};var b={"":"confirmSubmitDialogMessage","L":"confirmSubmitSelectedDialogMessage","O":"confirmSubmitCurrentMessage"};var _=a;var c=new J({confirmSubmitDialogMessage:""});var D=B.extend("fin.ap.approvebankpayments.controller.list.ConfirmSubmitDialog",{_resolve:null,_reject:null,constructor:function(v,d,e){var g=f[d]||f[""];var h=v.createId("ConfirmSubmitDialog");this._oDialog=U.xmlfragment(h,g,this);this._oDialog.setModel(c,"action");this.codeInput=F.byId(h,"nameInput");this.i18n=v.getModel("@i18n").getResourceBundle();c.setProperty("/confirmSubmitDialogTitle",this.i18n.getText(s[e]||s[""]));c.setProperty("/confirmSubmitDialogMessage",this.i18n.getText(b[e]||b[""]));v.addDependent(this._oDialog);return new Promise(function(r,R){this._resolve=r;this._reject=R;this._oDialog.open();}.bind(this));},onSubmitDialogOkPress:function(){var d=this.codeInput?this.codeInput.getValue():undefined;if(this.codeInput&&!d){this.codeInput.setValueStateText(this.i18n.getText("missingEntry"));this.codeInput.setValueState("Error");return;}this._oDialog.close();this._resolve(d);},onSubmitDialogCancelPress:function(){this._oDialog.close();this._reject();},onAfterSubmitClose:function(){this._oDialog.destroy();},sendSmsCode:function(){var m=this._oDialog.getModel();_.actionStarted(this.i18n.getText("confirmSubmitDialogTitle"));m.callFunction("/sendToken",{success:_.actionFinished.bind(null,this.i18n.getText("verificationSend")),error:function(){_.addActionError(this.i18n.getText("verificationNotSend"));_.actionFinished();}.bind(this),urlParameters:{Action:"'X'"},method:"POST"});}});D.addSubmitAllMessageStrip=function(t,d){var m=new M(t.getId()+"--submitReviewedMsgStrip",{enableFormattedText:true,showIcon:true,text:"{batchListView>/submitReviewedText}",type:"Information",visible:"{batchListView>/showSubmitStrip}"});var l=new L(m.getId()+"--submitReviewedLink",{text:"{@i18n>dialogSubmitButtonText}"});l.attachPress(d.onSubmitReviewed,d);m.addStyleClass("sapUiSmallMargin").setLink(l);t.insertContent(m,1);};return D;});
